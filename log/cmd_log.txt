[2m2026-02-11 15:19:15 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Metrics logging initialized with tracing
[2m2026-02-11 15:19:15 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Starting trading bot
[2m2026-02-11 15:20:18 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Metrics logging initialized with tracing
[2m2026-02-11 15:20:18 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Starting trading bot
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Metrics logging initialized with tracing
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Starting trading bot
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Loaded configuration: ["SOLUSD"]
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Kraken API keys loaded and validated
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m API Key: OhvP/6XE...
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m API Secret length: 88 characters
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Initializing KrakenClient with API key: OhvP/6XE..., startup_time: 1770841371
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m API secret length: 88 characters
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Kraken REST client initialized
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Testing Kraken API connection...
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Kraken server time: 1770841373000
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m WS Token API Response Status: 200 OK, Body: {"error":[],"result":{"expires":900,"token":"zuMqkuXue4qVZ69YB9TSKCiAY3+nzW/7XsQut150fWE"}}
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Fetched WS token, expires at 900
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Initialized WS token, expires at 900
[2m2026-02-11 15:22:51 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Validating Kraken API authentication...
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Attempting balance fetch with nonce: 1770841374000
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m API Response Status: 200 OK, Body: {"error":[],"result":{"ATOM":"47.67000000","DOT":"0.0000204824","INJ":"0.7486690016","LINK":"1.1973000000","PEPE":"38461.68","SHIB":"375644.33498","SOL":"0.8574812103","USDC":"0.00005300","USDG":"0.01956884","USDT":"0.00000000","XETH":"0.0000000073","XXBT":"0.0000000087","XXDG":"8952.75541175","XXRP":"0.00000000","ZUSD":"9.9986"}}
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Successfully authenticated with Kraken API
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m DEBUG: Full balance response: Object {
    "ATOM": String("47.67000000"),
    "DOT": String("0.0000204824"),
    "INJ": String("0.7486690016"),
    "LINK": String("1.1973000000"),
    "PEPE": String("38461.68"),
    "SHIB": String("375644.33498"),
    "SOL": String("0.8574812103"),
    "USDC": String("0.00005300"),
    "USDG": String("0.01956884"),
    "USDT": String("0.00000000"),
    "XETH": String("0.0000000073"),
    "XXBT": String("0.0000000087"),
    "XXDG": String("8952.75541175"),
    "XXRP": String("0.00000000"),
    "ZUSD": String("9.9986"),
}
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Raw ZUSD value: Some(String("9.9986"))
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Account USD balance fetched: 9.9986
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Validated USD balance: 9.9986
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "positions" already exists, skipping
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "trades" already exists, skipping
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "idx_trades_pair_timestamp" already exists, skipping
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "solusd_market_data" already exists, skipping
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "idx_solusd_market_data_timestamp" already exists, skipping
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m Created table and index solusd_market_data for pair SOLUSD
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m Database tables and indexes initialized successfully
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Database initialized successfully
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "positions" already exists, skipping
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "trades" already exists, skipping
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "solusd_market_data" already exists, skipping
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m DatabaseActor: Initialized tables for pairs: ["SOLUSD"]
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m About to update position for SOLUSD: usd_balance=0.0000, total_usd=0.0000
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updating position for SOLUSD with usd_balance: 0
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updated position for SOLUSD
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Updating position for SOLUSD - total_usd=0, total_quantity=0, usd_balance=0, is_buy=true
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Successfully updated/inserted position for SOLUSD, rows_affected: 1, final_usd_balance: 0
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Fetched total_pl -0.229889000000000000 for crypto
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updating position for USD with usd_balance: 0
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updated position for USD
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Updating position for USD - total_usd=0, total_quantity=0, usd_balance=0, is_buy=false
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Successfully updated/inserted position for USD, rows_affected: 1, final_usd_balance: 0
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Successfully updated position for SOLUSD after 0 retries
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Creating USD position with balance: 9.9986
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m About to update position for USD: usd_balance=9.9986, total_usd=0.0000
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updating position for USD with usd_balance: 9.9986
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updated position for USD
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Updating position for USD - total_usd=0, total_quantity=0, usd_balance=9.9986, is_buy=false
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Successfully updated/inserted position for USD, rows_affected: 1, final_usd_balance: 9.9986
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Successfully updated position for USD after 0 retries
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m About to sync USD balance: 9.9986
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Received request to sync USD balance to 9.9986
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Synced USD balance from 9.9986 to 9.9986
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updating position for USD with usd_balance: 9.9986
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updated position for USD
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Updating position for USD - total_usd=0, total_quantity=0, usd_balance=9.9986, is_buy=false
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Successfully updated/inserted position for USD, rows_affected: 1, final_usd_balance: 9.9986
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Successfully synced USD balance: 9.9986 after 0 retries
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m StateManager initialized with 2 positions, USD balance synced to database: 9.9986
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m WebSocket channels created for 1 pairs
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Connecting to public Kraken WebSocket v2 at wss://ws.kraken.com/v2
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m WS Token API Response Status: 200 OK, Body: {"error":[],"result":{"expires":900,"token":"OeGL79kWv4MFS34qNN23qYW2eo6eRm8U0/gGDXvBGRk"}}
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Fetched WS token, expires at 900
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Refreshed WS token, expires at 900
[2m2026-02-11 15:22:52 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Connecting to private Kraken WebSocket v2 at wss://ws-auth.kraken.com/v2
[2m2026-02-11 15:22:53 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Subscribing to public OHLC v2: {"method":"subscribe","params":{"channel":"ohlc","interval":1,"snapshot":true,"symbol":["SOL/USD"]}}
[2m2026-02-11 15:22:53 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Subscribing to public ticker v2: {"method":"subscribe","params":{"channel":"ticker","snapshot":true,"symbol":["SOL/USD"]}}
[2m2026-02-11 15:22:54 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m WS Token API Response Status: 200 OK, Body: {"error":[],"result":{"expires":900,"token":"Lytv5G480Bwg0uFyNCURB9/NM9B+dlr88ZYhMY981Lw"}}
[2m2026-02-11 15:22:54 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Fetched WS token, expires at 900
[2m2026-02-11 15:22:54 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Refreshed WS token, expires at 900
[2m2026-02-11 15:22:54 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Subscribing to private executions v2: {"method":"subscribe","params":{"channel":"executions","snap_orders":true,"snap_trades":true,"token":"Lytv5G480Bwg0uFyNCURB9/NM9B+dlr88ZYhMY981Lw"}}
[2m2026-02-11 15:23:03 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Public OHLC sub confirmed v2
[2m2026-02-11 15:23:04 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Private executions sub confirmed v2
[2m2026-02-11 15:23:04 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Sent initial ping after private sub
[2m2026-02-11 15:23:04 -05:00[0m [33m WARN[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Pong req_id mismatch: got 0, expected 1
[2m2026-02-11 15:23:22 -05:00[0m [33m WARN[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Public WS ready timeout after 30s; proceeding with fallback
[2m2026-02-11 15:23:22 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Private WS subscriptions confirmed
[2m2026-02-11 15:23:22 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Entering main loop with concurrent trading for 1 pairs
[2m2026-02-11 15:23:23 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Public ticker sub confirmed v2
[2m2026-02-11 15:23:23 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Sent initial ping after public subs
[2m2026-02-11 15:23:23 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Processed price update for SOLUSD: PriceUpdate { pair: "SOLUSD", bid: 0, ask: 0, close_price: 79.45, timestamp: "2026-02-11 15:23:00" }
[2m2026-02-11 15:23:23 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Processed price update for SOLUSD: PriceUpdate { pair: "SOLUSD", bid: 0, ask: 0, close_price: 79.44, timestamp: "2026-02-11 15:23:00" }
[2m2026-02-11 15:23:23 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Processed price update for SOLUSD: PriceUpdate { pair: "SOLUSD", bid: 0, ask: 0, close_price: 79.43, timestamp: "2026-02-11 15:23:00" }
[2m2026-02-11 15:23:23 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Processed price update for SOLUSD: PriceUpdate { pair: "SOLUSD", bid: 0, ask: 0, close_price: 79.42, timestamp: "2026-02-11 15:23:00" }
[2m2026-02-11 15:23:23 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Processed price update for SOLUSD: PriceUpdate { pair: "SOLUSD", bid: 0, ask: 0, close_price: 79.41, timestamp: "2026-02-11 15:23:00" }
[2m2026-02-11 15:23:23 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Processed price update for SOLUSD: PriceUpdate { pair: "SOLUSD", bid: 0, ask: 0, close_price: 79.41, timestamp: "2026-02-11 15:23:00" }
[2m2026-02-11 15:23:23 -05:00[0m [33m WARN[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Pong req_id mismatch: got 0, expected 1
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Received SIGINT, initiating shutdown...
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Initiating graceful shutdown of StateManager...
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Shutdown completed
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m TradeManager: Shutdown, returned cache of size 0
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m ExecuteBuy: Shutdown completed
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m ExecuteSell: Shutdown completed
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m DatabaseActor: Shutdown completed
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PriceActor[SOLUSD]: Shutdown completed
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::statemanager[0m[2m:[0m [2msrc\statemanager.rs[0m[2m:[0m Sent shutdown to 1 completion channels
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m MarketDataActor[SOLUSD]: Shutdown completed
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Shutdown complete
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::trading::trading_logic[0m[2m:[0m [2msrc\trading.rs[0m[2m:[0m Shutdown received in global trade sweep
[2m2026-02-11 15:23:36 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Shutdown signal received for pair SOLUSD
[2m2026-02-11 17:21:27 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Metrics logging initialized with tracing
[2m2026-02-11 17:21:27 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Starting trading bot
[2m2026-02-11 17:21:27 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Loaded configuration: ["SOLUSD"]
[2m2026-02-11 17:21:27 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Kraken API keys loaded and validated
[2m2026-02-11 17:21:27 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m API Key: OhvP/6XE...
[2m2026-02-11 17:21:27 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m API Secret length: 88 characters
[2m2026-02-11 17:21:27 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Initializing KrakenClient with API key: OhvP/6XE..., startup_time: 1770848487
[2m2026-02-11 17:21:27 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m API secret length: 88 characters
[2m2026-02-11 17:21:27 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Kraken REST client initialized
[2m2026-02-11 17:21:27 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Testing Kraken API connection...
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Kraken server time: 1770848489000
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m WS Token API Response Status: 200 OK, Body: {"error":[],"result":{"expires":900,"token":"DW3lA2grJn7nXyJIVt3jM8BMuBZ+Bee1hV5DkRw1vvo"}}
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Fetched WS token, expires at 900
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Initialized WS token, expires at 900
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Validating Kraken API authentication...
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Attempting balance fetch with nonce: 1770848491000
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m API Response Status: 200 OK, Body: {"error":[],"result":{"ATOM":"0.00000000","DOT":"0.0000204824","INJ":"0.7486690016","LINK":"1.1973000000","PEPE":"38461.68","SHIB":"375644.33498","SOL":"0.8574812103","USDC":"0.00005300","USDG":"0.01956884","USDT":"0.00000000","XETH":"0.0000000073","XXBT":"0.0000000087","XXDG":"8952.75541175","XXRP":"0.00000000","ZUSD":"102.5383"}}
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Successfully authenticated with Kraken API
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m DEBUG: Full balance response: Object {
    "ATOM": String("0.00000000"),
    "DOT": String("0.0000204824"),
    "INJ": String("0.7486690016"),
    "LINK": String("1.1973000000"),
    "PEPE": String("38461.68"),
    "SHIB": String("375644.33498"),
    "SOL": String("0.8574812103"),
    "USDC": String("0.00005300"),
    "USDG": String("0.01956884"),
    "USDT": String("0.00000000"),
    "XETH": String("0.0000000073"),
    "XXBT": String("0.0000000087"),
    "XXDG": String("8952.75541175"),
    "XXRP": String("0.00000000"),
    "ZUSD": String("102.5383"),
}
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Raw ZUSD value: Some(String("102.5383"))
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Account USD balance fetched: 102.5383
[2m2026-02-11 17:21:28 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Validated USD balance: 102.5383
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "positions" already exists, skipping
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "trades" already exists, skipping
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "idx_trades_pair_timestamp" already exists, skipping
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "solusd_market_data" already exists, skipping
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "idx_solusd_market_data_timestamp" already exists, skipping
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m Created table and index solusd_market_data for pair SOLUSD
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m Database tables and indexes initialized successfully
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Database initialized successfully
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "positions" already exists, skipping
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "trades" already exists, skipping
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtokio_postgres::connection[0m[2m:[0m [2mC:\Users\Edward\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-postgres-0.7.13\src\connection.rs[0m[2m:[0m NOTICE: relation "solusd_market_data" already exists, skipping
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m DatabaseActor: Initialized tables for pairs: ["SOLUSD"]
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m About to update position for SOLUSD: usd_balance=0.0000, total_usd=0.0000
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updating position for SOLUSD with usd_balance: 0
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updated position for SOLUSD
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Updating position for SOLUSD - total_usd=0, total_quantity=0, usd_balance=0, is_buy=true
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Successfully updated/inserted position for SOLUSD, rows_affected: 1, final_usd_balance: 0
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Fetched total_pl -0.229889000000000000 for crypto
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updating position for USD with usd_balance: 0
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updated position for USD
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Updating position for USD - total_usd=0, total_quantity=0, usd_balance=0, is_buy=false
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Successfully updated/inserted position for USD, rows_affected: 1, final_usd_balance: 0
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Successfully updated position for SOLUSD after 0 retries
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Creating USD position with balance: 102.5383
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m About to update position for USD: usd_balance=102.5383, total_usd=0.0000
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updating position for USD with usd_balance: 102.5383
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updated position for USD
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Updating position for USD - total_usd=0, total_quantity=0, usd_balance=102.5383, is_buy=false
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Successfully updated/inserted position for USD, rows_affected: 1, final_usd_balance: 102.5383
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Successfully updated position for USD after 0 retries
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m About to sync USD balance: 102.5383
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Received request to sync USD balance to 102.5383
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Synced USD balance from 102.5383 to 102.5383
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updating position for USD with usd_balance: 102.5383
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::actors[0m[2m:[0m [2msrc\actors.rs[0m[2m:[0m PositionsActor: Updated position for USD
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Updating position for USD - total_usd=0, total_quantity=0, usd_balance=102.5383, is_buy=false
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::db[0m[2m:[0m [2msrc\db.rs[0m[2m:[0m DB: Successfully updated/inserted position for USD, rows_affected: 1, final_usd_balance: 102.5383
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m Successfully synced USD balance: 102.5383 after 0 retries
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m StateManager initialized with 2 positions, USD balance synced to database: 102.5383
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs[0m[2m:[0m [2msrc\main.rs[0m[2m:[0m WebSocket channels created for 1 pairs
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Connecting to public Kraken WebSocket v2 at wss://ws.kraken.com/v2
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m WS Token API Response Status: 200 OK, Body: {"error":[],"result":{"expires":900,"token":"fR7R69iUiWpE5q7zNFRplSSEcmQ4gOWgQ7Q8Ma8QNyE"}}
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Fetched WS token, expires at 900
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Refreshed WS token, expires at 900
[2m2026-02-11 17:21:29 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Connecting to private Kraken WebSocket v2 at wss://ws-auth.kraken.com/v2
[2m2026-02-11 17:21:30 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Subscribing to public OHLC v2: {"method":"subscribe","params":{"channel":"ohlc","interval":1,"snapshot":true,"symbol":["SOL/USD"]}}
[2m2026-02-11 17:21:30 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Subscribing to public ticker v2: {"method":"subscribe","params":{"channel":"ticker","snapshot":true,"symbol":["SOL/USD"]}}
[2m2026-02-11 17:21:31 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m WS Token API Response Status: 200 OK, Body: {"error":[],"result":{"expires":900,"token":"H587q+ziv+IPPWFCKDCuv+cdIr25YBzF+AI5i/VDtY8"}}
[2m2026-02-11 17:21:31 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Fetched WS token, expires at 900
[2m2026-02-11 17:21:31 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::api[0m[2m:[0m [2msrc\api.rs[0m[2m:[0m Refreshed WS token, expires at 900
[2m2026-02-11 17:21:31 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Subscribing to private executions v2: {"method":"subscribe","params":{"channel":"executions","snap_orders":true,"snap_trades":true,"token":"H587q+ziv+IPPWFCKDCuv+cdIr25YBzF+AI5i/VDtY8"}}
[2m2026-02-11 17:21:40 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Public OHLC sub confirmed v2
[2m2026-02-11 17:21:41 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Private executions sub confirmed v2
[2m2026-02-11 17:21:41 -05:00[0m [32m INFO[0m [2mtrading_bot_rs::websocket[0m[2m:[0m [2msrc\websocket.rs[0m[2m:[0m Sent initial ping after private sub
